!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).PresentaBlockFitty=t()}(this,(function(){"use strict";var e="style_fitty__2IKDn",t="style_uppercase__2OfGL",n="style_fit__36Irr",i="style_prestyle__qyIzP";function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(":root{--fittyPadding:1rem}.style_fitty__2IKDn{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box;overflow:hidden;padding:var(--fittyPadding);font-family:var(--fontHeading)}.style_uppercase__2OfGL .style_fit__36Irr{text-transform:uppercase}.style_prestyle__qyIzP{box-sizing:border-box;text-align:center}.style_fit__36Irr{display:inline-block;white-space:nowrap;color:var(--colorFore);box-sizing:border-box}.style_fit__36Irr b,.style_fit__36Irr strong{color:var(--colorAccent)}");var o=r(function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e){if(e){var t=function(e){return[].slice.call(e)},i=0,r=1,o=2,l=3,a=[],c=null,s="requestAnimationFrame"in e?function(){e.cancelAnimationFrame(c),c=e.requestAnimationFrame((function(){return d(a.filter((function(e){return e.dirty&&e.active})))}))}:function(){},u=function(e){return function(){a.forEach((function(t){return t.dirty=e})),s()}},d=function(e){e.filter((function(e){return!e.styleComputed})).forEach((function(e){e.styleComputed=m(e)})),e.filter(h).forEach(v);var t=e.filter(y);t.forEach(p),t.forEach((function(e){v(e),f(e)})),t.forEach(w)},f=function(e){return e.dirty=i},p=function(e){e.availableWidth=e.element.parentNode.clientWidth,e.currentWidth=e.element.scrollWidth,e.previousFontSize=e.currentFontSize,e.currentFontSize=Math.min(Math.max(e.minSize,e.availableWidth/e.currentWidth*e.previousFontSize),e.maxSize),e.whiteSpace=e.multiLine&&e.currentFontSize===e.minSize?"normal":"nowrap"},y=function(e){return e.dirty!==o||e.dirty===o&&e.element.parentNode.clientWidth!==e.availableWidth},m=function(t){var n=e.getComputedStyle(t.element,null);t.currentFontSize=parseFloat(n.getPropertyValue("font-size")),t.display=n.getPropertyValue("display"),t.whiteSpace=n.getPropertyValue("white-space")},h=function(e){var t=!1;return!e.preStyleTestCompleted&&(/inline-/.test(e.display)||(t=!0,e.display="inline-block"),"nowrap"!==e.whiteSpace&&(t=!0,e.whiteSpace="nowrap"),e.preStyleTestCompleted=!0,t)},v=function(e){e.element.style.whiteSpace=e.whiteSpace,e.element.style.display=e.display,e.element.style.fontSize=e.currentFontSize+"px"},w=function(e){e.element.dispatchEvent(new CustomEvent("fit",{detail:{oldValue:e.previousFontSize,newValue:e.currentFontSize,scaleFactor:e.currentFontSize/e.previousFontSize}}))},b=function(e,t){return function(){e.dirty=t,e.active&&s()}},S=function(e){return function(){a=a.filter((function(t){return t.element!==e.element})),e.observeMutations&&e.observer.disconnect(),e.element.style.whiteSpace=e.originalStyle.whiteSpace,e.element.style.display=e.originalStyle.display,e.element.style.fontSize=e.originalStyle.fontSize}},g=function(e){return function(){e.active||(e.active=!0,s())}},_=function(e){return function(){return e.active=!1}},z=function(e){e.observeMutations&&(e.observer=new MutationObserver(b(e,r)),e.observer.observe(e.element,e.observeMutations))},x={minSize:16,maxSize:512,multiLine:!0,observeMutations:"MutationObserver"in e&&{subtree:!0,childList:!0,characterData:!0}},E=null,F=function(){e.clearTimeout(E),E=e.setTimeout(u(o),M.observeWindowDelay)},P=["resize","orientationchange"];return Object.defineProperty(M,"observeWindow",{set:function(t){var n=(t?"add":"remove")+"EventListener";P.forEach((function(t){e[n](t,F)}))}}),M.observeWindow=!0,M.observeWindowDelay=100,M.fitAll=u(l),M}function C(e,t){var i=n({},x,t),r=e.map((function(e){var t=n({},i,{element:e,active:!0});return function(e){e.originalStyle={whiteSpace:e.element.style.whiteSpace,display:e.element.style.display,fontSize:e.element.style.fontSize},z(e),e.newbie=!0,e.dirty=!0,a.push(e)}(t),{element:e,fit:b(t,l),unfreeze:g(t),freeze:_(t),unsubscribe:S(t)}}));return s(),r}function M(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e?C(t(document.querySelectorAll(e)),n):C([e],n)[0]}}("undefined"==typeof window?null:window)})));const l=function(r,l){const a=this;return new Promise(((c,s)=>{const u="sandfit"+(Math.random()+"").split(".")[1],d=document.createElement("div");d.classList.add(u,e);const f=l.linefactor||.8,p=l.width||100,y=l.uppercase?t:null,m=document.createElement("div");m.classList.add(i,y),m.style.width=p+"%";l.text.split("\n").forEach((e=>{const t=document.createElement("div");t.classList.add(n);const i=document.createElement("span");i.innerHTML=e,t.appendChild(i),m.appendChild(t)})),d.appendChild(m),r.appendChild(d),m.style.transform="scale(1)";let h=0;setTimeout((()=>{const e=o("."+u+" ."+n);e.forEach((t=>{const n=t.element;n.addEventListener("fit",(function(i){if(n.style.lineHeight=i.detail.newValue*f+"px",t.freeze(),h++,h>=e.length){const e=m.getBoundingClientRect(),t=m.parentNode.getBoundingClientRect().height/(e.height+40);t<1&&(m.style.transform=`scale(${t})`),c(a)}}))}))}),150)}))};return l.install=e=>{e.addBlock("fitty",l),e.addProp("fittyPadding")},"undefined"!=typeof window&&window.Presenta&&window.Presenta.use(l),l}));
